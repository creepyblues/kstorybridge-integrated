import{j as e}from"./ui-DHaiO8z9.js";import{r as m}from"./vendor-BZF0HjbR.js";import{u as Q,L as O}from"./router-DmKwpzBq.js";import{B as N,C as W,c as Y}from"./shared-eQ5Wlos0.js";import{t as q}from"./titlesService-CJzfHP0R.js";import{f as X}from"./featuredService-Cn0vU8T5.js";import{A as Z}from"./AdminLayout-oFsRbKDX.js";import{u as ee}from"./index-DaSXcfrj.js";import{R as ae,i as te,d as se,c as re,A as ne}from"./icons-BkT83dpJ.js";import"./utils-CfDMlrKu.js";import"./index-DZDudrgO.js";import"./backend-DY5GQkp5.js";const j={romantasy:["romance","fantasy"],romcom:["romance","comedy"],romfan:["romance","fantasy"],scifi:["sci_fi","science_fiction"],sciencefiction:["sci_fi","science","fiction"],sliceoflife:["slice_of_life","daily","life"],sol:["slice_of_life"],bl:["boys_love","yaoi","romance"],gl:["girls_love","yuri","romance"],yaoi:["boys_love","bl","romance"],yuri:["girls_love","gl","romance"],isekai:["fantasy","adventure","reincarnation"],cultivation:["fantasy","martial_arts","adventure"],litrpg:["fantasy","game","adventure"],dystopian:["sci_fi","thriller","drama"],cyberpunk:["sci_fi","thriller","futuristic"],steampunk:["fantasy","historical","adventure"],paranormal:["supernatural","fantasy","mystery"],supernatural:["paranormal","fantasy","horror"],psychological:["thriller","horror","mystery"],wholesome:["slice_of_life","comedy","heartwarming"],fluffy:["romance","comedy","wholesome"],angsty:["drama","tragedy","emotional"],enemies2lovers:["romance","drama"],enemiestolovers:["romance","drama"],slowburn:["romance","drama"],instalove:["romance"],harem:["romance","comedy"],reverse_harem:["romance","comedy"],otome:["romance","game"],villainess:["romance","comedy","isekai"],webtoon:["manhwa","comic","webcomic"],manhwa:["webtoon","comic","korean"],manhua:["comic","chinese"],manga:["comic","japanese"],webnovel:["novel","web_novel","online"],lightnovel:["novel","light_novel","ln"],ln:["light_novel","novel"],funny:["comedy","humor","comedic"],humorous:["comedy","funny"],comedic:["comedy","funny"],dark:["horror","thriller","mature"],mature:["adult","serious","dark"],lighthearted:["comedy","wholesome","fun"],heartwarming:["wholesome","feel_good","uplifting"],feelgood:["wholesome","heartwarming","uplifting"],emotional:["drama","tearjerker","moving"],tearjerker:["drama","emotional","sad"],uplifting:["inspirational","motivational","positive"],inspiring:["uplifting","motivational"],motivational:["inspiring","uplifting"],teen:["young_adult","ya","teenage"],ya:["young_adult","teen"],youngadult:["teen","ya"],adult:["mature","grown_up"],kids:["children","family","young"],children:["kids","family","young"],family:["all_ages","wholesome"],korean:["korea","k-content","hallyu"],kdrama:["korean","drama","tv"],kpop:["korean","music","idol"],chaebol:["korean","business","rich"],historical_korean:["historical","korean","traditional"],modern_korean:["contemporary","korean","modern"]},P={fantacy:["fantasy"],fantasie:["fantasy"],romanse:["romance"],romence:["romance"],mistry:["mystery"],mistery:["mystery"],thriler:["thriller"],horor:["horror"],commedy:["comedy"],comidy:["comedy"],acton:["action"],sifi:["sci_fi"],syfy:["sci_fi"]};function ie(o,n){if(o===n)return 1;const i=f=>{const l=new Set;for(let p=0;p<f.length-1;p++)l.add(f.substring(p,p+2));return l},u=i(o.toLowerCase()),r=i(n.toLowerCase()),h=new Set([...u].filter(f=>r.has(f))),c=new Set([...u,...r]);return h.size/c.size}function le(o){const n=o.toLowerCase().trim(),i=new Set([n]);j[n]&&j[n].forEach(r=>i.add(r)),P[n]&&P[n].forEach(r=>{i.add(r),j[r]&&j[r].forEach(h=>i.add(h))});const u=[...Object.keys(j),...Object.values(j).flat(),...Object.keys(P),...Object.values(P).flat()];for(const r of u){const h=ie(n,r);h>.7&&h<1&&(i.add(r),j[r]&&j[r].forEach(c=>i.add(c)))}return Array.from(i)}function oe(o,n,i){if(!n.trim())return{exactMatches:o,expandedMatches:[]};const u=n.toLowerCase().trim().split(/\s+/),r=u.flatMap(l=>le(l)),h=new Set(u),c=new Set,f=new Set;for(const l of o){let p=!1,y=!1;for(const v of i){const g=l[v];if(!g)continue;let x="";Array.isArray(g)?x=g.join(" ").toLowerCase():typeof g=="string"?x=g.toLowerCase():x=String(g).toLowerCase();for(const w of u)if(x.includes(w)){p=!0;break}for(const w of r)!h.has(w)&&x.includes(w)&&(y=!0)}p?c.add(l):y&&f.add(l)}return{exactMatches:Array.from(c),expandedMatches:Array.from(f)}}function ce(){return["title_name_en","title_name_kr","author","story_author","art_author","writer","illustrator","rights","rights_owner","tagline","description","synopsis","note","perfect_for","comps","tone","audience","genre","tags","content_format"]}const K=({children:o,className:n=""})=>e.jsxs("div",{className:`relative ${n}`,children:[e.jsx("div",{className:"filter blur-sm select-none",children:o}),e.jsx("div",{className:"absolute inset-0 bg-white/20 backdrop-blur-sm pointer-events-none"})]});function be(){Q();const[o,n]=m.useState([]),[i,u]=m.useState([]),[r,h]=m.useState(""),[c,f]=m.useState(""),[l,p]=m.useState(!1),[y,v]=m.useState(1),[g]=m.useState(50),[x,w]=m.useState(null),[C,z]=m.useState("asc"),[D,U]=m.useState(null);m.useEffect(()=>{localStorage.removeItem("admin_titles_cache"),localStorage.removeItem("admin_titles_cache_time"),localStorage.removeItem("admin_featured_cache"),localStorage.removeItem("admin_featured_cache_time"),$(!0)},[]);const $=async(a=!1)=>{try{p(!0);const t=24*60*60*1e3,s=Date.now();let d=[];const _=localStorage.getItem("admin_titles_cache"),T=localStorage.getItem("admin_titles_cache_time");!a&&_&&T&&s-parseInt(T)<t?d=JSON.parse(_):(d=await q.getAllTitles(),localStorage.setItem("admin_titles_cache",JSON.stringify(d)),localStorage.setItem("admin_titles_cache_time",s.toString())),n(d);let b=[];const S=localStorage.getItem("admin_featured_cache"),A=localStorage.getItem("admin_featured_cache_time");!a&&S&&A&&s-parseInt(A)<t?b=JSON.parse(S):(b=await X.getFeaturedTitles(),localStorage.setItem("admin_featured_cache",JSON.stringify(b)),localStorage.setItem("admin_featured_cache_time",s.toString())),u(b);const R=Math.max(parseInt(localStorage.getItem("admin_titles_cache_time")||"0"),parseInt(localStorage.getItem("admin_featured_cache_time")||"0"));R>0&&U(new Date(R).toLocaleString())}catch(t){console.error("Error loading data:",t),ee.error("Error loading titles")}finally{p(!1)}},F=()=>{localStorage.removeItem("admin_titles_cache"),localStorage.removeItem("admin_titles_cache_time"),localStorage.removeItem("admin_featured_cache"),localStorage.removeItem("admin_featured_cache_time"),$(!0)},G=a=>{a.preventDefault(),f(r.trim()),v(1)},J=()=>{h(""),f(""),v(1)},V=a=>{x===a?z(C==="asc"?"desc":"asc"):(w(a),z("asc"))},B=a=>x?[...a].sort((t,s)=>{let d,_;switch(x){case"title":d=t.title_name_en||t.title_name_kr||"",_=s.title_name_en||s.title_name_kr||"";break;case"genre":d=Array.isArray(t.genre)?t.genre.join(", "):t.genre||"",_=Array.isArray(s.genre)?s.genre.join(", "):s.genre||"";break;case"tone":d=t.tone||"",_=s.tone||"";break;case"keywords":const S=t.keywords||t.tags,A=s.keywords||s.tags;d=Array.isArray(S)?S.join(", "):S||"",_=Array.isArray(A)?A.join(", "):A||"";break;default:return 0}const T=String(d).toLowerCase(),b=String(_).toLowerCase();return T<b?C==="asc"?-1:1:T>b?C==="asc"?1:-1:0}):a,k=(()=>{let a=o;if(c){const{exactMatches:t,expandedMatches:s}=oe(o,c,ce());a=[...t,...s]}return B(a)})();m.useEffect(()=>{v(1)},[c,x,C]);const I=a=>Array.isArray(a)?a.map(t=>t.replace("_"," ").replace(/\b\w/g,s=>s.toUpperCase())).join(", "):a.replace("_"," ").replace(/\b\w/g,t=>t.toUpperCase()),L=({field:a,children:t,className:s=""})=>e.jsxs("button",{onClick:()=>V(a),className:`flex items-center gap-1 hover:text-gray-900 transition-colors ${s}`,children:[t,x===a?C==="asc"?e.jsx(se,{className:"w-4 h-4"}):e.jsx(re,{className:"w-4 h-4"}):e.jsx(ne,{className:"w-4 h-4 text-gray-400 opacity-60"})]}),E=Math.ceil(k.length/g),M=(y-1)*g,H=k.slice(M,M+g);return e.jsx(Z,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-porcelain-blue-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-5xl lg:text-6xl font-bold text-midnight-ink leading-tight mb-4",children:"TITLES"}),e.jsx("p",{className:"text-xl text-midnight-ink-600 leading-relaxed",children:"Manage and browse all Korean content titles."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-midnight-ink-600 text-sm",children:[e.jsxs("div",{className:"font-medium text-lg",children:[k.length," titles"]}),D&&e.jsxs("div",{className:"text-xs opacity-75",children:["Last updated: ",D]})]}),e.jsx(N,{asChild:!0,size:"sm",className:"bg-hanok-teal hover:bg-hanok-teal/90 text-white",children:e.jsx(O,{to:"/titles/new",children:"New title"})}),e.jsxs(N,{onClick:F,variant:"outline",size:"sm",disabled:l,className:"flex items-center gap-2 text-midnight-ink-600 border-porcelain-blue-300 hover:bg-porcelain-blue-100",children:[e.jsx(ae,{className:`w-4 h-4 ${l?"animate-spin":""}`}),"Refresh"]})]})]}),e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Featured Titles"}),l?e.jsx("div",{className:"text-center text-gray-500 py-8",children:"Loading featured titles..."}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-6",children:i.map(a=>{const t=a.titles;return e.jsx(O,{to:`/titles/${t.title_id}`,className:"block",children:e.jsxs(W,{className:"bg-white rounded-xl border-0 shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 group h-full flex flex-col",children:[e.jsx("div",{className:"aspect-[3/4] bg-gradient-to-br from-porcelain-blue-100 to-hanok-teal-100 flex items-center justify-center relative overflow-hidden",children:t.title_image?e.jsx("img",{src:t.title_image,alt:t.title_name_en||t.title_name_kr,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",onError:s=>{s.currentTarget.style.display="none"}}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-12 h-12 bg-hanok-teal rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 bg-white rounded-lg flex items-center justify-center",children:e.jsx("div",{className:"w-4 h-4 bg-hanok-teal rounded opacity-60"})})}),e.jsx("div",{className:"absolute top-2 right-2 w-3 h-3 bg-hanok-teal rounded-full"})]})}),e.jsxs(Y,{className:"p-3 flex flex-col flex-grow",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-sm font-bold text-midnight-ink mb-1 line-clamp-2",children:t.title_name_en||t.title_name_kr}),t.title_name_en&&t.title_name_kr&&e.jsx("p",{className:"text-xs text-midnight-ink-500 mb-1 line-clamp-1",children:t.title_name_kr}),e.jsx("p",{className:"text-xs text-midnight-ink-600 mb-2 line-clamp-2",children:t.tagline||t.pitch||"Discover this amazing Korean story"})]}),t.genre&&(Array.isArray(t.genre)?t.genre.length>0:!0)&&e.jsx("div",{className:"mt-auto",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[Array.isArray(t.genre)?t.genre.slice(0,1).map((s,d)=>e.jsx("div",{className:"inline-block bg-hanok-teal/10 text-hanok-teal px-2 py-1 rounded-full text-xs font-medium",children:I(s)},`${t.title_id}-card-genre-${d}`)):e.jsx("div",{className:"inline-block bg-hanok-teal/10 text-hanok-teal px-2 py-1 rounded-full text-xs font-medium",children:I(t.genre)}),Array.isArray(t.genre)&&t.genre.length>1&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",t.genre.length-1]})]})})]})]})},a.id)})})]}),e.jsxs("form",{onSubmit:G,className:"relative mb-8",children:[e.jsx(te,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-midnight-ink-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search titles... (press Enter or click Search)",value:r,onChange:a=>h(a.target.value),className:"w-full pl-12 pr-32 py-4 text-lg bg-porcelain-blue-50 border-0 rounded-2xl outline-none focus:ring-2 focus:ring-hanok-teal text-midnight-ink"}),e.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex gap-2",children:[c&&e.jsx(N,{type:"button",onClick:J,variant:"ghost",size:"sm",className:"text-midnight-ink-400 hover:text-midnight-ink-600",children:"Clear"}),e.jsx(N,{type:"submit",size:"sm",className:"bg-hanok-teal hover:bg-hanok-teal/90 text-white",children:"Search"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center font-semibold text-gray-700",children:[e.jsx("div",{className:"col-span-1",children:"Image"}),e.jsx("div",{className:"col-span-3",children:e.jsx(L,{field:"title",children:"Title"})}),e.jsx("div",{className:"col-span-2",children:e.jsx(L,{field:"genre",children:"Genre"})}),e.jsx("div",{className:"col-span-2",children:e.jsx(L,{field:"tone",children:"Tone"})}),e.jsx("div",{className:"col-span-2",children:e.jsx(L,{field:"keywords",children:"Keywords"})}),e.jsxs("div",{className:"col-span-1 relative flex flex-col items-center justify-center",children:[e.jsx("span",{children:"Comps"}),e.jsx("span",{className:"bg-rose-200/70 text-rose-800 text-[8px] px-1.5 py-0.5 rounded-full font-medium mt-1",children:"PRO PLAN"})]}),e.jsxs("div",{className:"col-span-1 relative flex flex-col items-center justify-center",children:[e.jsx("span",{children:"Audience"}),e.jsx("span",{className:"bg-rose-200/70 text-rose-800 text-[8px] px-1.5 py-0.5 rounded-full font-medium mt-1",children:"PRO PLAN"})]})]})}),l?e.jsx("div",{className:"px-6 py-12 text-center text-gray-500",children:"Loading titles..."}):k.length>0?e.jsx("div",{className:"divide-y divide-gray-100",children:H.map(a=>e.jsx(O,{to:`/titles/${a.title_id}`,className:"block",children:e.jsxs("div",{className:"px-6 py-4 grid grid-cols-12 gap-4 items-center hover:bg-gray-50 cursor-pointer transition-colors",children:[e.jsx("div",{className:"col-span-1",children:a.title_image?e.jsx("div",{className:"w-16 h-20 bg-gray-200 rounded-lg overflow-hidden",children:e.jsx("img",{src:a.title_image,alt:a.title_name_en||a.title_name_kr,className:"w-full h-full object-cover",onError:t=>{t.currentTarget.style.display="none",t.currentTarget.parentElement.classList.add("flex","items-center","justify-center"),t.currentTarget.parentElement.innerHTML='<span class="text-xs text-gray-400">No Image</span>'}})}):e.jsx("div",{className:"w-16 h-20 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-400",children:"No Image"})})}),e.jsxs("div",{className:"col-span-3",children:[e.jsx("div",{className:"font-medium text-gray-800 line-clamp-1",children:a.title_name_en||a.title_name_kr}),a.title_name_en&&a.title_name_kr&&e.jsx("div",{className:"text-sm text-gray-500 line-clamp-1 mt-1",children:a.title_name_kr})]}),e.jsx("div",{className:"col-span-2",children:a.genre&&(!Array.isArray(a.genre)||a.genre.length>0)?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[Array.isArray(a.genre)?a.genre.slice(0,2).map((t,s)=>e.jsx("div",{className:"inline-block bg-cyan-100 text-cyan-800 px-2 py-1 rounded-full text-xs font-medium",children:I(t)},`${a.title_id}-genre-${s}`)):e.jsx("div",{className:"inline-block bg-cyan-100 text-cyan-800 px-2 py-1 rounded-full text-xs font-medium",children:I(a.genre)}),Array.isArray(a.genre)&&a.genre.length>2&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",a.genre.length-2]})]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("div",{className:"col-span-2",children:a.tone?e.jsx("div",{className:"inline-block bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs font-medium",children:a.tone.replace("_"," ").replace(/\b\w/g,t=>t.toUpperCase())}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("div",{className:"col-span-2",children:a.tags&&a.tags.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.tags.slice(0,2).map((t,s)=>e.jsx("div",{className:"inline-block bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs font-medium",children:t},`${a.title_id}-tag-${s}`)),a.tags.length>2&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",a.tags.length-2]})]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx(K,{className:"col-span-1",children:a.comps?e.jsx("div",{className:"inline-block bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:a.comps}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx(K,{className:"col-span-1",children:a.audience?e.jsx("div",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:a.audience}):e.jsx("span",{className:"text-gray-400",children:"-"})})]})},a.title_id))}):e.jsx("div",{className:"px-6 py-12 text-center text-gray-500",children:c?"No titles found matching your search.":"No titles available."}),E>1&&e.jsx("div",{className:"border-t border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",M+1," to ",Math.min(M+g,k.length)," of ",k.length," results"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{variant:"outline",size:"sm",onClick:()=>v(a=>Math.max(a-1,1)),disabled:y===1,className:"text-midnight-ink-600 border-porcelain-blue-300 hover:bg-porcelain-blue-100",children:"Previous"}),e.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,E)},(a,t)=>{const s=t+1;return e.jsx(N,{variant:y===s?"default":"outline",size:"sm",onClick:()=>v(s),className:y===s?"bg-hanok-teal text-white hover:bg-hanok-teal/90":"text-midnight-ink-600 border-porcelain-blue-300 hover:bg-porcelain-blue-100",children:s},s)})}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>v(a=>Math.min(a+1,E)),disabled:y===E,className:"text-midnight-ink-600 border-porcelain-blue-300 hover:bg-porcelain-blue-100",children:"Next"})]})]})})]})]})})})}export{be as default};
